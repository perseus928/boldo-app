{"version":3,"sources":["CurvedTabBar.tsx"],"names":["AnimatedSvg","Animated","createAnimatedComponent","Svg","CurvedTabBarComponent","props","routes","selectedIndex","SIZE_DOT","dotSize","TAB_BAR_HEIGHT","barHeight","duration","dotColor","tabBarColor","Dimensions","get","width","setWidth","safeArea","clock","widthTab","length","indexAnimated","progress","d","HEIGHT_HOLE","containerStyle","styles","container","height","bottom","svgStyle","svg","top","transform","translateX","inputRange","map","item","index","outputRange","reverse","rowTab","bottomView","backgroundColor","to","from","handler","addEventListener","removeEventListener","key","configs","CurvedTabBar","prevProps","nextProps"],"mappings":"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","sourcesContent":["import React, { memo, useMemo, useState, useEffect } from 'react'\nimport { View, ViewStyle, StyleProp, Dimensions } from 'react-native'\nimport Svg, { Path } from 'react-native-svg'\nimport ButtonTabItem from './item/ButtonTabItem'\nimport Dot from './item/Dot';\n\nimport { TabBarViewProps } from '../types'\n\nimport { useSafeArea } from 'react-native-safe-area-context';\nimport Animated, { set, useCode, interpolate, eq, cond, not } from 'react-native-reanimated';\nimport { useValues, timing, withTimingTransition, useClocks } from 'react-native-redash'\n\nimport equals from 'react-fast-compare'\n\nimport { styles } from './style'\nimport { HEIGHT_HOLE } from './constant';\n\nconst AnimatedSvg = Animated.createAnimatedComponent(Svg);\n\n\nconst CurvedTabBarComponent = (props: TabBarViewProps) => {\n    // props\n    const { routes,\n        selectedIndex,\n        dotSize: SIZE_DOT,\n        barHeight: TAB_BAR_HEIGHT,\n        duration,\n        dotColor,\n        tabBarColor } = props;\n\n    const [width, setWidth] = useState(Dimensions.get('window').width)\n    const safeArea = useSafeArea()\n    const [clock] = useClocks(1)\n    const widthTab = useMemo(() => width / routes.length, [routes, width])\n\n    // animated\n    const [indexAnimated] = useValues(0)\n    const progress = withTimingTransition(eq(selectedIndex, indexAnimated), { duration: 150, })\n\n    // path\n    const d = useMemo(() =>\n        `M0,0 L${width + widthTab / 2 - SIZE_DOT},0\n    C${width + widthTab / 2 - SIZE_DOT * 0.5},0 ${width + widthTab / 2 - SIZE_DOT * 0.75},${HEIGHT_HOLE} ${width + widthTab / 2},${HEIGHT_HOLE} \n    C${width + widthTab / 2 + SIZE_DOT * 0.75},${HEIGHT_HOLE} ${width + widthTab / 2 + SIZE_DOT * 0.5},0 ${width + widthTab / 2 + SIZE_DOT} 0 \n    L${width * 2},0 L ${width * 2},${TAB_BAR_HEIGHT} L 0,${TAB_BAR_HEIGHT} Z\n    `, [width, SIZE_DOT, TAB_BAR_HEIGHT, routes, safeArea]);\n\n    // style\n    const containerStyle = useMemo<StyleProp<ViewStyle>>(\n        () => [\n            styles.container,\n            {\n                height: TAB_BAR_HEIGHT,\n                bottom: safeArea.bottom,\n            },\n        ],\n        [safeArea]\n    );\n    const svgStyle = [\n        styles.svg, {\n            top: 0,\n            height: TAB_BAR_HEIGHT,\n            transform: [{\n                translateX: interpolate(indexAnimated, {\n                    inputRange: routes.map((item: any, index: number) => index),\n                    outputRange: routes.map((item: any, index: number) => -((index + 1) * width / routes.length)).reverse()\n                })\n            }]\n        }\n    ] as StyleProp<Animated.AnimateStyle<ViewStyle>>;\n    const rowTab = useMemo(() => [\n        styles.rowTab,\n        { bottom: safeArea.bottom, width: width, height: TAB_BAR_HEIGHT }\n    ], [safeArea, TAB_BAR_HEIGHT, width])\n\n    const bottomView = useMemo<StyleProp<ViewStyle>>(() => [\n        styles.bottomView,\n        {\n            height: safeArea.bottom,\n            width: width,\n            backgroundColor: tabBarColor,\n        }],\n        [safeArea, width, tabBarColor])\n\n    // effect\n    useCode(() => cond(not(eq(indexAnimated, selectedIndex)), set(indexAnimated, timing({ to: selectedIndex, clock: clock, from: indexAnimated, duration: duration }))), [selectedIndex])\n    useEffect(() => {\n        const handler = () => {\n            setWidth(Dimensions.get('window').width)\n        }\n        Dimensions.addEventListener('change', handler)\n        return () => {\n            Dimensions.removeEventListener('change', handler)\n        }\n    }, [])\n    return (\n        <>\n            <View style={containerStyle}>\n                <AnimatedSvg width={width * 2} height={TAB_BAR_HEIGHT} style={svgStyle}>\n                    <Path d={`${d}`} fill={tabBarColor} stroke={'transparent'} strokeWidth={1} />\n                </AnimatedSvg>\n            </View>\n            <View style={rowTab} >\n                <Dot dotColor={dotColor} dotSize={SIZE_DOT} barHeight={TAB_BAR_HEIGHT} width={width} selectedIndex={indexAnimated} routes={routes} progress={progress} />\n                {routes.map(({ key, ...configs }, index) => {\n                    return <ButtonTabItem\n                        width={width}\n                        key={key}\n                        clock={clock}\n                        indexAnimated={indexAnimated}\n                        countTab={routes.length}\n                        selectedIndex={selectedIndex}\n                        index={index} {...configs} />\n                }\n                )}\n            </View>\n            <View style={bottomView} />\n        </>\n    )\n}\n\nconst CurvedTabBar = memo(CurvedTabBarComponent, (prevProps, nextProps) => equals(prevProps, nextProps))\n\nexport default CurvedTabBar\n\n"]}